---
title: "[Ad-Oracle-Sql] 6. Handling Data in PL/SQL Blocks"

categories:
  - Ad-Oracle-Sql
tags:
  - [Handling Data, PL/SQL]

toc: true
toc_sticky: true

date: 2023-10-19
last_modified_at: 2023-10-19
---

{% capture notice-2 %}

ðŸ“‹ This is my note-taking from what I learned in the class "Advanced Database Concepts"
{% endcapture %}

<div class="notice--danger">{{ notice-2 | markdownify }}</div>

<!-- ðŸ“‹ This is my note-taking from what I learned in the LinkedIn Learning course "Explore a Career in SQL Development"
{: .notice--danger} -->

<br>

# Objective

- SQL queries in PL/SQL
- The %TYPE attribute
- Expanding block processing to include queries and control structures
- Embedding DML statements in PL/SQL
- Using record variables
- Creating collections
- Bulk processing basics
- GOTO statement

<br>

# Brewbeanâ€™s Challenge

Consider actions needed upon check out

![img](../../assets/images/Brewbeanâ€™s%20Challenge-2.png)

<br>

# Include SQL within a Block

Data query needs to identify if the customer has a saved basket

![img](../../assets/images/Include%20SQL%20within%20a%20Block.png)

- SQL statements can be embedded into the executable area of a PL/SQL block
- SELECT statements are embedded to query needed data
- An INTO clause is added to a SELECT statement to move data retrieved into variables

![img](<../../assets/images/Include%20SQL%20within%20a%20Block%20(continued).png>)

<br>

# Executing a Block with Errors

Common Errors

- Use = rather than `:=`
- Not declaring a variable
- Misspelling a variable name
- Not ending a statement with `;`
- No data returned from a SELECT statement
- Not closing a statement with `;`
  : ![img](../../assets/images/Not%20closing%20a%20statement%20with%20;%20.png)

<br>

# %TYPE Attribute

- Use in variable declaration to provide data type based on a table column
- Ideal for declaring variables that will hold data from the database
- Minimizes maintenance by avoiding program changes to reflect database column changes
- Called an anchored data type

```
lv_basket_num bb_basket.idBasket%TYPE;
```

<br>

# Data Retrieval with Decision Structures

![img](../../assets/images/Data%20Retrieval%20with%20Decision%20Structures.png)

<br>

# IF Statement Example

![img](../../assets/images/IF%20Statement%20Example.png)

<br>

# Including DML

- DML statements can be embedded into PL/SQL blocks to accomplish data changes
- DML includes INSERT, UPDATE, and DELETE statements
- Add a new shopper - INSERT
  : ![img](<../../assets/images/Including%20DML%20(continued).png>)

<br>

# Record variables

- Stores multiple values of different data types as one unit
- Record â€“ can hold one row of data

<br>

# Record Data Type

![img](../../assets/images/Record%20Data%20Type.png)

<br>

# %ROWTYPE Attribute

Create record structure based on table structure

```
DECLARE

rec_shopper bb_shopper%ROWTYPE;

BEGIN

SELECT *
INTO rec_shopper
FROM bb_shopper
WHERE idshopper = 25;

DBMS_OUTPUT.PUT_LINE(rec_shopper.lastname);
DBMS_OUTPUT.PUT_LINE(rec_shopper.address);
DBMS_OUTPUT.PUT_LINE(rec_shopper.email);
END;
```

<br>

# INSERT Using Record

![img](../../assets/images/INSERT%20Using%20Record%20.png)

<br>

# Collections

- Store multiple values of the same data type
- Similar to arrays in other languages
- Associative Arrayâ€“ handle many rows of one field

![img](../../assets/images/Collections.png)

<br>

# Associative Array Attributes

![img](../../assets/images/Associative%20Array%20Attributes.png)

<br>

# Associative Array Example

![img](../../assets/images/Associative%20Array%20Example.png)

![img](<../../assets/images/Example%20(continued).png>)

<br>

# Table of Records

- Contains one or more records
- Handle shopping basket data

![img](../../assets/images/Table%20of%20Records.png)
![img](../../assets/images/Table%20of%20Records-2.png)

<br>

# Bulk Processing

- Improve performance & add capabilities
- Reduces context switching
- Groups SQL actions for processing
- BULK COLLECT and FORALL statements
- Enables loading multi-row query directly to table of record variable
  : ![img](../../assets/images/Bulk%20Processing.png)

<br>

# GOTO Statement

- Jumping control that instructs the program to move to another area of code to continue processing
- Most developers discourage the use of GOTO as it complicates the flow of execution

<br>

# Summary

- SQL queries and DML statements can be embedded into a block
- An INTO clause must be added to a SELECT
- The %TYPE attribute is used to use a column data type
- Composite data types can hold multiple values in a single variable
- A record can hold a row of data
- A table of records can hold multiple rows of data
- The %ROWTYPE attribute can be used to declare a data type based on a tableâ€™s structure
- An associative array is a collection of same type data
- Bulk processing groups SQL statements for processing to improve performance
- The GOTO statement enables execution to jump to specific portions of code

<br>

---

<br>

[Back to Top](#){: .btn .btn--primary }{: .align-right}
